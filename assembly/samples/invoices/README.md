# Sample: Invoices

This is a Maven project to demonstrate the unmarshalling of XML files using an XML Schema to generate the **JAXB** classes.

## Execution

This is a stand-alone Maven project. You can run the test using:

~~~
mvn clean test
mvn compile exec:java
~~~

The [output][2] shows the test results.

### Problem ( from [StackOverflow](https://stackoverflow.com/questions/74590721/) )

Generate **JAXB** classes from this [XSD@pastebin](https://pastebin.com/vPkqH75k) and use the classes to unmarshal this [XML@pastebin](https://pastebin.com/hiR3cjsy).

Demonstrate the ability to unmarshal an XML file using a Java standard engine application with this constructor:

~~~
public Aufgabe4(String path) throws JAXBException
{
    File f = new File(path);
    JAXBContext context = JAXBContext.newInstance("generated");
    Unmarshaller unmarshaller = context.createUnmarshaller();
    InvoiceList invoiceList = (InvoiceList) JAXBIntrospector.getValue(
        unmarshaller.unmarshal(f));
}
~~~

### Solution

**JAXB** generates Java classes from XML Schema file(s) using its **XJC** compiler. This solution uses a Maven project to invoke **XJC** using the [hisrc-higherjaxb-maven-plugin][9].

[Here][1] is a Maven project named **Invoices** using the standard file layout. This project includes:

+ An XML Schema file [Invoices.xsd][4] for the `Invoice` model
+ An XML Sample file [Invoices01-1.xml][5] for unmarshalling
+ A JAXB *binding* file [Invoices.xjb][6] for configuration
+ A JUnit test class [InvoicesTest.java][7] to verify (un)marshalling
+ Sample XML [files][8] with `InvoiceList` data.
+ The Maven POM file with `hisrc-higherjaxb-maven-plugin`

~~~
Invoices
    src
        main
            java
            resources
                Invoices.xsd
                Invoices.xjb
                simplelogger.properties
        test
            java
                namespace/my/invoices/InvoicesTest.java
            resources
                simplelogger.properties
            samples
                Invoices01-1.xml
    pom.xml
~~~

The **JAXB** classes are generated by this plugin using this project's [pom.xml][3]

~~~
<plugin>
    <groupId>org.patrodyne.jvnet</groupId>
    <artifactId>hisrc-higherjaxb-maven-plugin</artifactId>
    <version>${hisrc-higherjaxb-maven-plugin.version}</version>
    <executions>
        <execution>
            <goals>
                <goal>generate</goal>
            </goals>
            <configuration>
                <args>
                    <arg>-no-header</arg>
                    <arg>-XhashCode</arg>
                    <arg>-Xequals</arg>
                    <arg>-XtoString</arg>
                </args>
                <plugins>
                    <plugin>
                        <groupId>org.patrodyne.jvnet</groupId>
                        <artifactId>hisrc-basicjaxb-plugins</artifactId>
                        <version>${hisrc-basicjaxb.version}</version>
                    </plugin>
                </plugins>
            </configuration>
        </execution>
    </executions>
</plugin>
~~~

and are generated to:

~~~
target/generated-sources/xjc/

namespace
└── my
    └── invoices
        ├── AddressType.java
        ├── BankDetailsType.java
        ├── BillingInfo.java
        ├── BillingType.java
        ├── Company.java
        ├── ContactType.java
        ├── CurrencyCodesType.java
        ├── CurrencyType.java
        ├── CustomerInfo.java
        ├── Customer.java
        ├── Invoice.java
        ├── InvoiceList.java
        ├── Items.java
        ├── ItemType.java
        ├── ObjectFactory.java
        ├── Other.java
        ├── package-info.java
        └── TaxesType.java
~~~

##### Approach

The [hisrc-higherjaxb-maven-plugin][9] is configured to generate **JAXB** classes using the provided [Invoices.xsd][4] schema. The schema provides the namespace `"my.namespace/Invoices"` which **JAXB** uses to create the Java `package` name using its own naming convention.

As an option, a more advanced implementation of Java's built-in `Object` methods are generated using these **XJC** [hisrc-basicjaxb-plugins][10]. In particular, the sample project uses the `toString` plugin to display *human-readable* representations of the unmarshaled `Invoice` objects.

**hisrc-basicjaxb-plugins**
~~~
<args>
    <arg>-no-header</arg>
    <arg>-XhashCode</arg>
    <arg>-Xequals</arg>
    <arg>-XtoString</arg>
</args>
~~~

> *Note:* When the **XJC** [hisrc-basicjaxb-plugins][10] are used, the [hisrc-basicjaxb-runtime][10] dependency is required on the run-time class path.

##### Testing

The JUnit test class, [InvoicesTest.java][7], scans for the sample files and invokes the method `checkSample(File sample)` to provide each file to the tester. For this project, a `JAXBContext` is created and each file in the [samples][8] path is *unmarshaled* to a `InvoiceList` object. When successful, each object is *marshaled* for logging and your [review][2].

##### Demonstration

A Java standard engine application with a `main(...)` method is at [`namespace.my.invoices.Aufgabe4`][11]. This application is executed using:

~~~
mvn compile exec:java "src/test/samples/Invoices01-1.xml"
~~~

<!-- References -->

[1]: https://github.com/patrodyne/hisrc-higherjaxb/releases/download/2.1.0/hisrc-higherjaxb-sample-invoices-2.1.0-mvn-src.zip
[2]: https://github.com/patrodyne/hisrc-higherjaxb/blob/master/assembly/samples/invoices/OUTPUT.txt
[3]: https://github.com/patrodyne/hisrc-higherjaxb/blob/master/assembly/samples/invoices/project-pom.xml
[4]: https://github.com/patrodyne/hisrc-higherjaxb/blob/master/assembly/samples/invoices/src/main/resources/Invoices.xsd
[5]: https://github.com/patrodyne/hisrc-higherjaxb/blob/master/assembly/samples/invoices/src/test/samples/Invoices01-1.xml
[6]: https://github.com/patrodyne/hisrc-higherjaxb/blob/master/assembly/samples/invoices/src/main/resources/Invoices.xjb
[7]: https://github.com/patrodyne/hisrc-higherjaxb/blob/master/assembly/samples/invoices/src/test/java/com/models/InvoicesTest.java
[8]: https://github.com/patrodyne/hisrc-higherjaxb/tree/master/assembly/samples/invoices/src/test/samples
[9]: https://github.com/patrodyne/hisrc-higherjaxb#readme
[10]: https://github.com/patrodyne/hisrc-basicjaxb#readme
[11]: https://github.com/patrodyne/hisrc-higherjaxb/blob/master/assembly/samples/invoices/src/main/java/namespace/my/invoices/Aufgabe4.java
