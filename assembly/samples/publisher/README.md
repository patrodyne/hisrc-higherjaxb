# Sample: Publisher

This is a Maven project to demonstrate the unmarshalling of XML files using an XML Schema to generate the JAXB classes.

## Execution

This is a stand-alone Maven project. You can run the test using:

~~~
mvn -Ptest clean test
~~~

The [output][2] shows the test results.

### Problem ( from [StackOverflow](https://stackoverflow.com/questions/75793473) )

Use the *HiSrc HigherJAXB Maven Plugin* to generate JAXB classes from two XML namespaces:

+ `Publisher-BCResponse.xsd`
+ `Publisher-Request.xsd`

Where the first schema uses element(s) from the second schema. The goals are:

+ Package the `BCResponse` class(es) into `com.models.response`,
+ Package the `Request` class(es) into `com.models.request`,
+ Use the default XML namespace for the `BCResponse` class(es),
+ Use a separate and specific namespace for the `Request` class(es),
+ Unmarshal an XML instance like this one:

~~~
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<BCResponse xmlns:ns2="http://uri.abc.com/ML">
  <publisher>ACME</publisher>
  <content>
    <ns2:Request>
      <legalEntity>
        <partyId>
          <id>ID-001</id>
        </partyId>
      </legalEntity>
    </ns2:Request>
    <Response>
      <ResponseStatus>
        <statusType>ERROR</statusType>
      </ResponseStatus>
    </Response>
  </content>
</BCResponse>
~~~

### Solutions

+ Schema First Design
+ Java First Design

#### Schema First Design

Let's begin with the XML example for `BCResponse` and create XML Schema(s) for the given elements. Then JAXB can generate the Java classes using its XJC compiler.

[Here][1] is a Maven project named **Publisher** using the standard file layout. This project includes:

+ An XML Schema file [Publisher-BCResponse.xsd][4] for the `BCResponse` model
+ An XML Schema file [Publisher-Request.xsd][5] for the `Request` model
+ A JAXB *binding* file [Publisher.xjb][6] for package configuration
+ A JUnit test class [PublisherTest.java][7] to verify (un)marshalling
+ Sample XML [files][8] with `Publisher` data.
+ The Maven POM file with `hisrc-higherjaxb-maven-plugin`

~~~
Publisher
    src
        main
            java
            resources
                Publisher-BCResponse.xsd
                Publisher-Request.xsd
                Publisher.xjb
        test
            java
                com/models/PublisherTest.java
            resources
                simplelogger.properties
            samples
                BCResponse01.xml
                BCResponse02.xml
                Request01.xml
    pom.xml
~~~

The JAXB classes are generated by this plugin using this project's [pom.xml][3]

~~~
<plugin>
    <groupId>org.patrodyne.jvnet</groupId>
    <artifactId>hisrc-higherjaxb-maven-plugin</artifactId>
    <version>${hisrc-higherjaxb-maven-plugin.version}</version>
    <executions>
        <execution>
            <goals>
                <goal>generate</goal>
            </goals>
        </execution>
    </executions>
</plugin>
~~~

and are generated to:

~~~
target/generated-sources/xjc/

com
└── models
    ├── request
    │   ├── LegalEntity.java
    │   ├── ObjectFactory.java
    │   ├── package-info.java
    │   ├── PartyId.java
    │   └── Request.java
    └── response
        ├── BCResponse.java
        ├── Content.java
        ├── ObjectFactory.java
        ├── Response.java
        └── ResponseStatus.java
~~~

##### Approach

The [Publisher-BCResponse.xsd][4] schema does not declare a namespace and is configured to *import* the [Publisher-Request.xsd][5] schema using the prefix `"ns2"`.

~~~
xmlns:ns2="http://uri.abc.com/ML"
<xs:import namespace="http://uri.abc.com/ML" schemaLocation="Publisher-Request.xsd"/>
~~~

> Note: The prefix is arbitrary and could have been `"abc"`

The [Publisher-Request.xsd][5] schema declares its namespace, as follows:

~~~
xmlns:tns="http://uri.abc.com/ML"
targetNamespace="http://uri.abc.com/ML"
~~~

The [Publisher.xjb][6] binding file configures JAXB to generate the classes, as follows:

~~~
<jaxb:package name="com.models.request"/>
<jaxb:package name="com.models.response"/>
~~~

##### Testing

The JUnit test class, [PublisherTest.java][7], scans for the sample files and invokes the method `checkSample(File sample)` to provide each file to the tester. For this project, a `JAXBContext` is created and each file in the [samples][8] path is *unmarshaled* to a `BCResponse` object or a `Request` object. When successful, each object is *marshaled* for logging and your [review][2].

#### Java First Design

In this approach the JAXB classes are created by you. Here's how they should look:

**package-info.java**
~~~
@jakarta.xml.bind.annotation.XmlSchema(namespace = "http://uri.abc.com/ML")
package com.models.request;
~~~

**Request.java**
~~~
package com.models.request;

import java.io.Serializable;
import jakarta.xml.bind.annotation.*;

@XmlAccessorType(XmlAccessType.FIELD)
@XmlType(name = "", propOrder = { "legalEntity" })
@XmlRootElement(name = "Request")
public class Request implements Serializable
{
    private static final long serialVersionUID = 20230301L;

    @XmlElement(required = true)
    protected LegalEntity legalEntity;
    public LegalEntity getLegalEntity() { return legalEntity; }
    public void setLegalEntity(LegalEntity value) { this.legalEntity = value; }
}
~~~

**LegalEntity.java**
~~~
package com.models.request;

import java.io.Serializable;
import jakarta.xml.bind.annotation.*;

@XmlAccessorType(XmlAccessType.FIELD)
@XmlType(name = "", propOrder = { "partyId" })
public class LegalEntity implements Serializable
{
    private static final long serialVersionUID = 20230301L;

    @XmlElement(required = true)
    protected PartyId partyId;
    public PartyId getPartyId() { return partyId; }
    public void setPartyId(PartyId value) { this.partyId = value; }
}
~~~

**PartyId.java**
~~~
package com.models.request;

import java.io.Serializable;
import jakarta.xml.bind.annotation.*;

@XmlAccessorType(XmlAccessType.FIELD)
@XmlType(name = "", propOrder = { "id" })
public class PartyId implements Serializable
{
    private static final long serialVersionUID = 20230301L;

    @XmlElement(required = true)
    protected String id;
    public String getId() { return id; }
    public void setId(String value) { this.id = value; }
}
~~~

**BCResponse.java**
~~~
package com.models.response;

import java.io.Serializable;
import jakarta.xml.bind.annotation.*;

@XmlAccessorType(XmlAccessType.FIELD)
@XmlType(name = "", propOrder = { "publisher", "content" })
@XmlRootElement(name = "BCResponse")
public class BCResponse implements Serializable
{
    private static final long serialVersionUID = 20230301L;

    @XmlElement(required = true)
    protected String publisher;
    public String getPublisher() { return publisher; }
    public void setPublisher(String value) { this.publisher = value; }

    @XmlElement(required = true)
    protected Content content;
    public Content getContent() { return content; }
    public void setContent(Content value) { this.content = value; }
}

~~~

**Content.java**
~~~
package com.models.response;

import java.io.Serializable;
import com.models.request.Request;
import jakarta.xml.bind.annotation.*;

@XmlAccessorType(XmlAccessType.FIELD)
@XmlType(name = "", propOrder = { "request", "response" })
public class Content implements Serializable
{
    private static final long serialVersionUID = 20230301L;

    @XmlElement(name = "Request", namespace = "http://uri.abc.com/ML", required = true)
    protected Request request;
    public Request getRequest() { return request; }
    public void setRequest(Request value) { this.request = value; }

    @XmlElement(name = "Response", required = true)
    protected Response response;
    public Response getResponse() { return response; }
    public void setResponse(Response value) { this.response = value; }
}
~~~

**Response.java**
~~~
package com.models.response;

import java.io.Serializable;
import jakarta.xml.bind.annotation.*;

@XmlAccessorType(XmlAccessType.FIELD)
@XmlType(name = "", propOrder = { "responseStatus" })
public class Response implements Serializable
{
    private static final long serialVersionUID = 20230301L;

    @XmlElement(name = "ResponseStatus", required = true)
    protected ResponseStatus responseStatus;
    public ResponseStatus getResponseStatus() { return responseStatus; }
    public void setResponseStatus(ResponseStatus value) { this.responseStatus = value; }
}
~~~

**ResponseStatus.java**
~~~
package com.models.response;

import java.io.Serializable;
import jakarta.xml.bind.annotation.*;

@XmlAccessorType(XmlAccessType.FIELD)
@XmlType(name = "", propOrder = { "statusType" })
public class ResponseStatus implements Serializable
{
    private static final long serialVersionUID = 20230301L;

    @XmlElement(required = true)
    protected String statusType;
    public String getStatusType() { return statusType; }
    public void setStatusType(String value) { this.statusType = value; }
}
~~~


<!-- References -->

[1]: https://github.com/patrodyne/hisrc-higherjaxb/releases/download/2.1.0/hisrc-higherjaxb-sample-publisher-2.1.0-mvn-src.zip
[2]: https://github.com/patrodyne/hisrc-higherjaxb/blob/master/assembly/samples/publisher/OUTPUT.txt
[3]: https://github.com/patrodyne/hisrc-higherjaxb/blob/master/assembly/samples/publisher/project-pom.xml
[4]: https://github.com/patrodyne/hisrc-higherjaxb/blob/master/assembly/samples/publisher/src/main/resources/Publisher-BCResponse.xsd
[5]: https://github.com/patrodyne/hisrc-higherjaxb/blob/master/assembly/samples/publisher/src/main/resources/Publisher-Request.xsd
[6]: https://github.com/patrodyne/hisrc-higherjaxb/blob/master/assembly/samples/publisher/src/main/resources/Publisher.xjb
[7]: https://github.com/patrodyne/hisrc-higherjaxb/blob/master/assembly/samples/publisher/src/test/java/com/models/PublisherTest.java
[8]: https://github.com/patrodyne/hisrc-higherjaxb/tree/master/assembly/samples/publisher/src/test/samples



